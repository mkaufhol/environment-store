[tox]
envlist = py310,py311,py312,py313
isolated_build = True
skip_missing_interpreters = True

[testenv]
description = Run unit tests with pytest and coverage
deps =
    pytest>=8.4.2
    moto>=5.1.15
    coverage>=7.11.0
    boto3>=1.40.57
commands =
    coverage run -m pytest {posargs:tests/}
    coverage report -m
    coverage html

[testenv:coverage]
description = Run tests with detailed coverage report for validation module
deps =
    {[testenv]deps}
commands =
    coverage run -m pytest tests/environment_store/ssm_parameter_store/test_validation.py -v
    coverage report -m
    coverage html
    coverage report --fail-under=100

[testenv:validation-only]
description = Run only validation tests with 100% coverage requirement
deps =
    {[testenv]deps}
commands =
    pytest tests/environment_store/ssm_parameter_store/test_validation.py -v --tb=short
    coverage run --source=environment_store.ssm_parameter_store.validation -m pytest tests/environment_store/ssm_parameter_store/test_validation.py
    coverage report -m --fail-under=100

[coverage:run]
source = src
omit =
    */tests/*
    */test_*.py
branch = True

[coverage:report]
precision = 2
show_missing = True
skip_covered = False

[coverage:html]
directory = htmlcov
